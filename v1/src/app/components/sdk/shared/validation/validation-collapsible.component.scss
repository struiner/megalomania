@import '../sdk-shell/sdk-shell-tokens';
@import './validation-tokens';

// Validation Collapsible Component Styles
//遵循 UI Charter: unobtrusive, deterministic rendering, secondary attention zone

.validation-collapsible {
  @extend %validation-notice-base;
  border-radius: var(--validation-notice-radius);
  margin: var(--validation-notice-margin);
  
  // Severity variants for header styling
  &--error {
    @extend %validation-notice-error;
  }
  
  &--warning {
    @extend %validation-notice-warning;
  }
  
  &--info {
    @extend %validation-notice-info;
  }

  // Header section (always visible)
  &__header {
    @extend %sdk-button-reset;
    display: flex;
    align-items: center;
    gap: var(--sdk-spacing-xs, 6px);
    width: 100%;
    padding: var(--validation-notice-padding);
    background: transparent;
    border: none;
    cursor: pointer;
    text-align: left;
    border-radius: var(--validation-notice-radius);
    transition: background-color var(--sdk-transition-fast, 0.15s) ease;
    
    &:hover {
      background: rgba(255, 255, 255, 0.02);
    }
    
    &:focus-visible {
      outline: 2px solid var(--sdk-color-accent, #8abdf7);
      outline-offset: 2px;
    }
  }

  // Icon in header
  &__icon {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    flex-shrink: 0;
    
    &::before {
      content: '';
    }
    
    &--error::before {
      content: var(--validation-error-icon);
    }
    
    &--warning::before {
      content: var(--validation-warning-icon);
    }
    
    &--info::before {
      content: var(--validation-info-icon);
    }
  }

  // Summary text
  &__summary {
    flex: 1 1 auto;
    font-weight: var(--sdk-font-weight-medium, 500);
    line-height: 1.3;
    min-width: 0; // Allow text truncation
  }

  // Count badge for multiple notices
  &__count {
    font-size: var(--sdk-font-size-xs, 12px);
    opacity: 0.7;
    flex-shrink: 0;
  }

  // Chevron indicator
  &__chevron {
    font-size: 10px;
    transition: transform var(--sdk-transition-fast, 0.15s) ease;
    flex-shrink: 0;
    
    &.expanded {
      transform: rotate(180deg);
    }
  }

  // Content section (expandable)
  &__content {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: all var(--sdk-transition-normal, 0.25s) ease;
    
    &.expanded {
      max-height: 500px; // Reasonable max height for content
      opacity: 1;
      margin-top: var(--sdk-spacing-xs, 6px);
    }
  }

  // Individual notices container
  &__notices {
    display: flex;
    flex-direction: column;
    gap: var(--sdk-spacing-xs, 6px);
    padding: 0 var(--validation-notice-padding);
  }
}

// Compact variant for tight spaces
.validation-collapsible--compact {
  .validation-collapsible__header {
    padding: var(--sdk-spacing-xs, 6px) var(--sdk-spacing-sm, 8px);
  }
  
  .validation-collapsible__summary {
    font-size: var(--sdk-font-size-xs, 12px);
  }
  
  .validation-collapsible__icon {
    width: 14px;
    height: 14px;
    font-size: 10px;
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .validation-collapsible {
    border-width: 2px;
    
    &__header:hover {
      background: rgba(255, 255, 255, 0.05);
    }
  }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  .validation-collapsible {
    &__chevron,
    &__content {
      transition: none;
    }
  }
}

// Dark theme adjustments
@media (prefers-color-scheme: dark) {
  .validation-collapsible {
    &__header:hover {
      background: rgba(255, 255, 255, 0.03);
    }
  }
}